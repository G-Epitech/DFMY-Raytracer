<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Raytracer: object-plugins</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Raytracer
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">object-plugins </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><img src="https://upload.wikimedia.org/wikipedia/commons/4/42/Baby.gnu-800x800.png" alt="Baby gnu" title="Baby gnu" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md0"></a>
DFMY-Raytracer Object Plugins</h1>
<p>A rendering engine should be extensible. One should be able to add new features without completely rewriting the code.</p>
<p>For every step of this documentation you can check the Sphere object</p>
<h3><a class="anchor" id="autotoc_md1"></a>
Build</h3>
<p>All of the object plugins are found in the <code>objects</code> folder, in the folder we have a CMake that will be automatically called by the CMake at the root that looks like this: </p><div class="fragment"><div class="line"># Set the shared library prefix to an empty string</div>
<div class="line">set(CMAKE_SHARED_LIBRARY_PREFIX &quot;&quot;)</div>
<div class="line"> </div>
<div class="line"># Add the subdirectories</div>
</div><!-- fragment --><p>Basically here you will add the subdirectory of your object plugin with the name of your object. For example: </p><div class="fragment"><div class="line">add_subdirectory(sphere)</div>
</div><!-- fragment --><p>Now in your sphere subdirectory, you need to create your own CMake that will build your plugin, it should look like this: </p><div class="fragment"><div class="line"># Setup Raytracer Sphere library</div>
<div class="line">add_library(raytracer_sphere SHARED)</div>
<div class="line"> </div>
<div class="line"># Link Raytracer Sphere library</div>
<div class="line">target_link_libraries(raytracer_sphere PRIVATE raytracer_common)</div>
<div class="line"> </div>
<div class="line"># Add sources to Raytracer Sphere library</div>
<div class="line">target_sources(raytracer_sphere PRIVATE</div>
<div class="line">    export.cpp</div>
<div class="line">    src/SphereProvider.hpp</div>
<div class="line">    src/SphereProvider.cpp</div>
<div class="line">    src/Sphere.hpp</div>
<div class="line">    src/Sphere.cpp</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line"># Include directories for Raytracer Sphere library</div>
<div class="line">target_include_directories(raytracer_sphere PUBLIC ${CMAKE_CURRENT_SOURCE_DIR}/src)</div>
<div class="line">target_include_directories(raytracer_sphere PUBLIC ${CMAKE_CURRENT_SOURCE_DIR}/../..)</div>
</div><!-- fragment --><p>You will put all of your files in the <code>tareget_sources</code> section. And we will go over each file later in this documentation.</p>
<h3><a class="anchor" id="autotoc_md2"></a>
Architecture</h3>
<p>Every object plugin has a specific architecture, they each need to follow a certain inheritance tree, to be compatible with the rest of the Raytracer.</p>
<hr  />
<h6>Object Fields</h6>
<p>Each object has the following common fields:</p><ul>
<li>name (mainly used for GUI)</li>
<li>material</li>
<li>rotation</li>
<li>origin/position</li>
<li><b>special property</b></li>
</ul>
<p>The special property is a field that's unique for each object. Ex: radius for the sphere</p>
<hr  />
<h6>IObject Interface</h6>
<p>This is the core of our object (see: <code><a class="el" href="IObject_8hpp_source.html">common/interfaces/IObject.hpp</a></code>).</p>
<p>In the object interface we will have multiple methods. <code>virtual Math::HitInfo computeCollision(const Math::Ray &amp;ray) = 0;</code></p>
<p>This method is used by our raycasting system to know if a ray hit your object, so it can work out the reflections and pixels correctly. It is very important to correctly fill the <code>Math::HitInfo</code> structure correctly.</p>
<p>The interface also contains a method that returns the material associated to the object, also used by our raycasting system.</p>
<hr  />
<h6>IObjectProvider Interface</h6>
<p>Seeing that each object plugin is a dynamic library we will need a provider. An instance of this provider will be returned in the entrypoint to the plugin (more on the entrypoint later).</p>
<p>A provider needs to have the following things:</p><ul>
<li>object creator</li>
<li>manifest getter</li>
<li>unique property parser</li>
</ul>
<p>The <b>object creator</b> is just a method that takes in parameters the fields of an object and returns a shared pointer to the object it provides</p>
<p>The <b>manifest</b> is important, it contains the author of the plugin, the description, version, etc... But it also contains the name of the object, this is later used in the config. So if the name of our object in the manifest is "Sphere" it also needs to be "Sphere" in the config. (see config docs).</p>
<p>Unique property parser, is used to parse the unique properties of the object. Here the libconfig++ is used. A lot of utils functions are available in the <code>common/config/ConfigUtils.hpp</code> file. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
